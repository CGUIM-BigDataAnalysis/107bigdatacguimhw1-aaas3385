107-2 大數據分析方法 作業一
================
put your name here

搞不清楚各行各業的薪資差異嗎? 念研究所到底對第一份工作的薪資影響有多大? CP值高嗎? 透過分析**初任人員平均經常性薪資**- [開放資料連結](https://data.gov.tw/dataset/6647)，可初步了解台灣近幾年各行各業、各學歷的起薪。

比較103年度和106年度大學畢業者的薪資資料
----------------------------------------

### 資料匯入與處理

``` r
library(readr)
```

    ## Warning: package 'readr' was built under R version 3.5.3

``` r
library(dplyr)
```

    ## Warning: package 'dplyr' was built under R version 3.5.3

    ## 
    ## Attaching package: 'dplyr'

    ## The following objects are masked from 'package:stats':
    ## 
    ##     filter, lag

    ## The following objects are masked from 'package:base':
    ## 
    ##     intersect, setdiff, setequal, union

``` r
X103 <- read_csv("C:/Users/user/Desktop/103年各教育程度別初任人員經常性薪資─按大職類分.csv")
```

    ## Parsed with column specification:
    ## cols(
    ##   年度 = col_double(),
    ##   大職業別 = col_character(),
    ##   `經常性薪資-薪資` = col_double(),
    ##   `經常性薪資-女/男` = col_double(),
    ##   `國中及以下-薪資` = col_character(),
    ##   `國中及以下-女/男` = col_character(),
    ##   `高中或高職-薪資` = col_character(),
    ##   `高中或高職-女/男` = col_character(),
    ##   `專科-薪資` = col_character(),
    ##   `專科-女/男` = col_character(),
    ##   `大學-薪資` = col_character(),
    ##   `大學-女/男` = col_character(),
    ##   `研究所及以上-薪資` = col_character(),
    ##   `研究所及以上-女/男` = col_character()
    ## )

``` r
X104 <- read_csv("C:/Users/user/Desktop/104年各教育程度別初任人員經常性薪資─按大職類分.csv")
```

    ## Parsed with column specification:
    ## cols(
    ##   年度 = col_double(),
    ##   大職業別 = col_character(),
    ##   `經常性薪資-薪資` = col_double(),
    ##   `經常性薪資-女/男` = col_character(),
    ##   `國中及以下-薪資` = col_character(),
    ##   `國中及以下-女/男` = col_character(),
    ##   `高中或高職-薪資` = col_character(),
    ##   `高中或高職-女/男` = col_character(),
    ##   `專科-薪資` = col_character(),
    ##   `專科-女/男` = col_character(),
    ##   `大學-薪資` = col_character(),
    ##   `大學-女/男` = col_character(),
    ##   `研究所及以上-薪資` = col_character(),
    ##   `研究所及以上-女/男` = col_character()
    ## )

``` r
X105 <- read_csv("C:/Users/user/Desktop/105年各教育程度別初任人員每人每月經常性薪資─按大職類分.csv")
```

    ## Parsed with column specification:
    ## cols(
    ##   年度 = col_double(),
    ##   大職業別 = col_character(),
    ##   `經常性薪資-薪資` = col_double(),
    ##   `經常性薪資-女/男` = col_character(),
    ##   `國中及以下-薪資` = col_character(),
    ##   `國中及以下-女/男` = col_character(),
    ##   `高中或高職-薪資` = col_character(),
    ##   `高中或高職-女/男` = col_character(),
    ##   `專科-薪資` = col_character(),
    ##   `專科-女/男` = col_character(),
    ##   `大學-薪資` = col_character(),
    ##   `大學-女/男` = col_character(),
    ##   `研究所及以上-薪資` = col_character(),
    ##   `研究所及以上-女/男` = col_character()
    ## )

``` r
X106 <- read_csv("C:/Users/user/Desktop/106年各教育程度別初任人員每人每月經常性薪資─按大職類分.csv")
```

    ## Parsed with column specification:
    ## cols(
    ##   年度 = col_double(),
    ##   大職業別 = col_character(),
    ##   `經常性薪資-薪資` = col_double(),
    ##   `經常性薪資-女/男` = col_character(),
    ##   `國中及以下-薪資` = col_character(),
    ##   `國中及以下-女/男` = col_character(),
    ##   `高中或高職-薪資` = col_character(),
    ##   `高中或高職-女/男` = col_character(),
    ##   `專科-薪資` = col_character(),
    ##   `專科-女/男` = col_character(),
    ##   `大學-薪資` = col_character(),
    ##   `大學-女/男` = col_character(),
    ##   `研究所及以上-薪資` = col_character(),
    ##   `研究所及以上-女/男` = col_character()
    ## )

### 106年度薪資較103年度薪資高的職業有哪些?

``` r
X106$大職業別<-gsub("_","、",X106$大職業別)
join<-full_join(X103,X106,by="大職業別")
join$rate<-join$`經常性薪資-薪資.y`/join$`經常性薪資-薪資.x`
dataframe1<-data.frame(大職業別=head(join[order(join$rate,decreasing = T),"大職業別"],10),rate=head(join[order(join$rate,decreasing = T),"rate"],10))
knitr::kable(dataframe1)
```

| 大職業別                                            |      rate|
|:----------------------------------------------------|---------:|
| 運輸及倉儲業-基層技術工及勞力工                     |  1.134204|
| 住宿及餐飲業-服務及銷售工作人員                     |  1.130318|
| 住宿及餐飲業-基層技術工及勞力工                     |  1.114218|
| 專業、科學及技術服務業-專業人員                     |  1.107862|
| 藝術、娛樂及休閒服務業-技藝、機械設備操作及組裝人員 |  1.107322|
| 電力及燃氣供應業-基層技術工及勞力工                 |  1.103988|
| 用水供應及污染整治業-技術員及助理專業人員           |  1.103425|
| 運輸及倉儲業-技藝、機械設備操作及組裝人員           |  1.102979|
| 其他服務業-技術員及助理專業人員                     |  1.102977|
| 其他服務業-基層技術工及勞力工                       |  1.101849|

### 提高超過5%的的職業有哪些?

``` r
library(dplyr)
filter1<-filter(join,rate>1.05)
select1<-select(filter1,大職業別,rate)
knitr::kable(select1)
```

| 大職業別                                            |      rate|
|:----------------------------------------------------|---------:|
| 工業及服務業部門                                    |  1.055434|
| 工業及服務業部門-事務支援人員                       |  1.054445|
| 工業及服務業部門-服務及銷售工作人員                 |  1.057411|
| 工業及服務業部門-技藝、機械設備操作及組裝人員       |  1.051849|
| 工業及服務業部門-基層技術工及勞力工                 |  1.076858|
| 工業部門                                            |  1.050409|
| 工業部門-服務及銷售工作人員                         |  1.052265|
| 工業部門-基層技術工及勞力工                         |  1.071886|
| 製造業                                              |  1.051058|
| 製造業-技藝、機械設備操作及組裝人員                 |  1.050806|
| 製造業-基層技術工及勞力工                           |  1.076452|
| 電力及燃氣供應業-服務及銷售工作人員                 |  1.074269|
| 電力及燃氣供應業-基層技術工及勞力工                 |  1.103988|
| 用水供應及污染整治業                                |  1.072575|
| 用水供應及污染整治業-專業人員                       |  1.054500|
| 用水供應及污染整治業-技術員及助理專業人員           |  1.103425|
| 用水供應及污染整治業-事務支援人員                   |  1.068213|
| 用水供應及污染整治業-服務及銷售工作人員             |  1.099418|
| 用水供應及污染整治業-技藝、機械設備操作及組裝人員   |  1.070696|
| 用水供應及污染整治業-基層技術工及勞力工             |  1.074222|
| 營造業-專業人員                                     |  1.059997|
| 營造業-事務支援人員                                 |  1.051106|
| 營造業-服務及銷售工作人員                           |  1.089053|
| 營造業-基層技術工及勞力工                           |  1.051931|
| 服務業部門                                          |  1.063219|
| 服務業部門-專業人員                                 |  1.053967|
| 服務業部門-技術員及助理專業人員                     |  1.057542|
| 服務業部門-事務支援人員                             |  1.063967|
| 服務業部門-服務及銷售工作人員                       |  1.064820|
| 服務業部門-技藝、機械設備操作及組裝人員             |  1.061240|
| 服務業部門-基層技術工及勞力工                       |  1.085855|
| 批發及零售業                                        |  1.055367|
| 批發及零售業-專業人員                               |  1.051431|
| 批發及零售業-事務支援人員                           |  1.057173|
| 批發及零售業-服務及銷售工作人員                     |  1.055517|
| 批發及零售業-基層技術工及勞力工                     |  1.087005|
| 運輸及倉儲業                                        |  1.087113|
| 運輸及倉儲業-技術員及助理專業人員                   |  1.091938|
| 運輸及倉儲業-事務支援人員                           |  1.094685|
| 運輸及倉儲業-服務及銷售工作人員                     |  1.060425|
| 運輸及倉儲業-技藝、機械設備操作及組裝人員           |  1.102979|
| 運輸及倉儲業-基層技術工及勞力工                     |  1.134204|
| 住宿及餐飲業                                        |  1.089297|
| 住宿及餐飲業-技術員及助理專業人員                   |  1.086635|
| 住宿及餐飲業-事務支援人員                           |  1.056896|
| 住宿及餐飲業-服務及銷售工作人員                     |  1.130318|
| 住宿及餐飲業-技藝、機械設備操作及組裝人員           |  1.053980|
| 住宿及餐飲業-基層技術工及勞力工                     |  1.114218|
| 資訊及通訊傳播業                                    |  1.091328|
| 資訊及通訊傳播業-專業人員                           |  1.096461|
| 資訊及通訊傳播業-技術員及助理專業人員               |  1.062452|
| 資訊及通訊傳播業-事務支援人員                       |  1.070676|
| 資訊及通訊傳播業-服務及銷售工作人員                 |  1.069487|
| 資訊及通訊傳播業-技藝、機械設備操作及組裝人員       |  1.077994|
| 金融及保險業-事務支援人員                           |  1.057011|
| 金融及保險業-基層技術工及勞力工                     |  1.073309|
| 不動產業-專業人員                                   |  1.065710|
| 專業、科學及技術服務業                              |  1.078781|
| 專業、科學及技術服務業-專業人員                     |  1.107862|
| 專業、科學及技術服務業-技術員及助理專業人員         |  1.063539|
| 專業、科學及技術服務業-事務支援人員                 |  1.061095|
| 專業、科學及技術服務業-服務及銷售工作人員           |  1.052293|
| 專業、科學及技術服務業-技藝、機械設備操作及組裝人員 |  1.093671|
| 專業、科學及技術服務業-基層技術工及勞力工           |  1.084890|
| 支援服務業                                          |  1.056695|
| 支援服務業-技術員及助理專業人員                     |  1.068529|
| 支援服務業-事務支援人員                             |  1.055759|
| 支援服務業-服務及銷售工作人員                       |  1.075603|
| 支援服務業-基層技術工及勞力工                       |  1.067556|
| 教育服務業                                          |  1.083031|
| 教育服務業-專業人員                                 |  1.072763|
| 教育服務業-技術員及助理專業人員                     |  1.098900|
| 教育服務業-事務支援人員                             |  1.089630|
| 教育服務業-服務及銷售工作人員                       |  1.087040|
| 教育服務業-技藝、機械設備操作及組裝人員             |  1.064759|
| 教育服務業-基層技術工及勞力工                       |  1.069848|
| 醫療保健服務業-技術員及助理專業人員                 |  1.059212|
| 藝術、娛樂及休閒服務業                              |  1.070756|
| 藝術、娛樂及休閒服務業-事務支援人員                 |  1.080647|
| 藝術、娛樂及休閒服務業-服務及銷售工作人員           |  1.063185|
| 藝術、娛樂及休閒服務業-技藝、機械設備操作及組裝人員 |  1.107322|
| 藝術、娛樂及休閒服務業-基層技術工及勞力工           |  1.099976|
| 其他服務業                                          |  1.057514|
| 其他服務業-專業人員                                 |  1.093220|
| 其他服務業-技術員及助理專業人員                     |  1.102977|
| 其他服務業-事務支援人員                             |  1.064329|
| 其他服務業-技藝、機械設備操作及組裝人員             |  1.090853|
| 其他服務業-基層技術工及勞力工                       |  1.101849|

### 主要的職業種別是哪些種類呢?

``` r
select1$大職業別<-gsub("-[\u2E80-\u9FFF]+","",select1$大職業別)
table1<-table(select1$大職業別)
knitr::kable(table1)
```

| Var1                   |  Freq|
|:-----------------------|-----:|
| 工業及服務業部門       |     5|
| 工業部門               |     3|
| 不動產業               |     1|
| 支援服務業             |     5|
| 用水供應及污染整治業   |     7|
| 住宿及餐飲業           |     6|
| 批發及零售業           |     5|
| 其他服務業             |     6|
| 服務業部門             |     7|
| 金融及保險業           |     2|
| 專業、科學及技術服務業 |     7|
| 教育服務業             |     7|
| 資訊及通訊傳播業       |     6|
| 運輸及倉儲業           |     6|
| 電力及燃氣供應業       |     2|
| 製造業                 |     3|
| 營造業                 |     4|
| 醫療保健服務業         |     1|
| 藝術、娛樂及休閒服務業 |     5|

男女同工不同酬現況分析
----------------------

男女同工不同酬一直是性別平等中很重要的問題，分析資料來源為103到106年度的大學畢業薪資。

### 103到106年度的大學畢業薪資資料，哪些行業男生薪資比女生薪資多?

``` r
X106$`大學-女/男`<-gsub("—|…","",X106$`大學-女/男`)
X106$`大學-女/男`<-as.numeric(X106$`大學-女/男`)
X105$`大學-女/男`<-gsub("—|…","",X105$`大學-女/男`)
X105$`大學-女/男`<-as.numeric(X105$`大學-女/男`)
X104$`大學-女/男`<-gsub("—|…","",X104$`大學-女/男`)
X104$`大學-女/男`<-as.numeric(X104$`大學-女/男`)
X103$`大學-女/男`<-gsub("—|…","",X103$`大學-女/男`)
X103$`大學-女/男`<-as.numeric(X103$`大學-女/男`)
dataframe3<-data.frame("一零三大職業別"=head(X103[order(X103$`大學-女/男`),"大職業別"],10),"一零三大學-女/男"=head(X103[order(X103$`大學-女/男`),"大學-女/男"],10),
                       "一零四大職業別"=head(X104[order(X104$`大學-女/男`),"大職業別"],10),"一零四大學-女/男"=head(X104[order(X104$`大學-女/男`),"大學-女/男"],10),
                       "一零五大職業別"=head(X105[order(X105$`大學-女/男`),"大職業別"],10),"一零五大學-女/男"=head(X105[order(X105$`大學-女/男`),"大學-女/男"],10),
                       "一零六大職業別"=head(X106[order(X106$`大學-女/男`),"大職業別"],10),"一零六大學-女/男"=head(X106[order(X106$`大學-女/男`),"大學-女/男"],10))
knitr::kable(dataframe3)
```

| 大職業別                                            | 大學.女.男 | 大職業別.1                                        | 大學.女.男.1 | 大職業別.2                                    | 大學.女.男.2 | 大職業別.3                                    | 大學.女.男.3 |
|:----------------------------------------------------|:----------:|:--------------------------------------------------|:------------:|:----------------------------------------------|:------------:|:----------------------------------------------|:------------:|
| 礦業及土石採取業-技藝、機械設備操作及組裝人員       |    84.97   | 電力及燃氣供應業-技藝、機械設備操作及組裝人員     |     91.69    | 不動產業-技藝、機械設備操作及組裝人員         |     91.38    | 電力及燃氣供應業-技藝、機械設備操作及組裝人員 |     95.51    |
| 教育服務業-技藝、機械設備操作及組裝人員             |    88.49   | 教育服務業-服務及銷售工作人員                     |     91.90    | 醫療保健服務業-專業人員                       |     94.98    | 營造業-服務及銷售工作人員                     |     95.93    |
| 其他服務業-技術員及助理專業人員                     |    89.36   | 礦業及土石採取業-技術員及助理專業人員             |     92.42    | 用水供應及污染整治業-事務支援人員             |     95.04    | 其他服務業-事務支援人員                       |     96.23    |
| 電力及燃氣供應業-技藝、機械設備操作及組裝人員       |    91.77   | 礦業及土石採取業-技藝、機械設備操作及組裝人員     |     93.10    | 營造業-事務支援人員                           |     95.65    | 電力及燃氣供應業-技術員及助理專業人員         |     96.54    |
| 礦業及土石採取業-服務及銷售工作人員                 |    92.57   | 礦業及土石採取業                                  |     95.28    | 不動產業-事務支援人員                         |     95.66    | 其他服務業                                    |     96.57    |
| 營造業                                              |    95.58   | 其他服務業-事務支援人員                           |     95.47    | 營造業                                        |     95.78    | 住宿及餐飲業-技藝、機械設備操作及組裝人員     |     96.58    |
| 教育服務業-事務支援人員                             |    95.83   | 營造業-技藝、機械設備操作及組裝人員               |     95.64    | 營造業-專業人員                               |     96.52    | 營造業                                        |     96.71    |
| 教育服務業                                          |    95.91   | 用水供應及污染整治業-技藝、機械設備操作及組裝人員 |     95.90    | 資訊及通訊傳播業-技藝、機械設備操作及組裝人員 |     96.64    | 教育服務業-專業人員                           |     96.71    |
| 藝術、娛樂及休閒服務業-技藝、機械設備操作及組裝人員 |    96.13   | 營造業                                            |     96.35    | 不動產業-服務及銷售工作人員                   |     96.68    | 運輸及倉儲業-事務支援人員                     |     96.83    |
| 其他服務業                                          |    96.21   | 教育服務業                                        |     96.44    | 其他服務業                                    |     96.72    | 其他服務業-技術員及助理專業人員               |     96.84    |

### 哪些行業女生薪資比男生薪資多?

``` r
filter2<-filter(X103,`大學-女/男`>100)
filter3<-filter(X104,`大學-女/男`>100)
filter4<-filter(X105,`大學-女/男`>100)
filter5<-filter(X106,`大學-女/男`>100)
select2<-select(filter2,`大職業別`,`大學-女/男`)
select3<-select(filter3,`大職業別`,`大學-女/男`)
select4<-select(filter4,`大職業別`,`大學-女/男`)
select5<-select(filter5,`大職業別`,`大學-女/男`)
names(select2)[1]<-"大職業別103"
names(select3)[1]<-"大職業別104"
names(select4)[1]<-"大職業別105"
names(select5)[1]<-"大職業別106"
knitr::kable(select2)
```

| 大職業別103 |  大學-女/男|
|:------------|-----------:|

``` r
knitr::kable(select3)
```

| 大職業別104                                         | 大學-女/男 |
|:----------------------------------------------------|:----------:|
| 專業、科學及技術服務業-技藝、機械設備操作及組裝人員 |   100.26   |

``` r
knitr::kable(select4)
```

| 大職業別105           | 大學-女/男 |
|:----------------------|:----------:|
| 金融及保險業-專業人員 |   100.11   |

``` r
knitr::kable(select5)
```

| 大職業別106                         | 大學-女/男 |
|:------------------------------------|:----------:|
| 資訊及通訊傳播業-服務及銷售工作人員 |   100.33   |

研究所薪資差異
--------------

以106年度的資料來看，哪個職業別念研究所最划算呢 (研究所學歷薪資與大學學歷薪資增加比例最多)?

``` r
X106$`研究所及以上-薪資`<-gsub("—|…","",X106$`研究所及以上-薪資`)
X106$`大學-薪資`<-gsub("—|…","",X106$`大學-薪資`)
X106$`研究所及以上-薪資`<-as.numeric(X106$`研究所及以上-薪資`)
X106$`大學-薪資`<-as.numeric(X106$`大學-薪資`)
X106$morerate<-X106$`研究所及以上-薪資`/X106$`大學-薪資`
dataframe2<-data.frame(大職業別=head(X106[order(X106$morerate,decreasing = T),"大職業別"],10),morerate=head(X106[order(X106$morerate,decreasing = T),"morerate"],10))
knitr::kable(dataframe2)
```

| 大職業別                            |  morerate|
|:------------------------------------|---------:|
| 礦業及土石採取業-事務支援人員       |  1.208946|
| 專業、科學及技術服務業              |  1.202982|
| 其他服務業-技術員及助理專業人員     |  1.199470|
| 專業、科學及技術服務業-事務支援人員 |  1.192306|
| 批發及零售業                        |  1.191916|
| 製造業                              |  1.188350|
| 藝術、娛樂及休閒服務業-事務支援人員 |  1.187705|
| 工業部門                            |  1.183455|
| 工業及服務業部門                    |  1.182346|
| 服務業部門                          |  1.181334|

我有興趣的職業別薪資狀況分析
----------------------------

### 有興趣的職業別篩選，呈現薪資

``` r
library(dplyr)
A<-X106[86,]%>%
select(`大職業別`,`大學-薪資`,`研究所及以上-薪資`)
A$year<-106
B<-X105[86,]%>%
  select(`大職業別`,`大學-薪資`,`研究所及以上-薪資`)
B$year<-105
C<-X104[86,]%>%
  select(`大職業別`,`大學-薪資`,`研究所及以上-薪資`)
C$year<-104
D<-X103[86,]%>%
  select(`大職業別`,`大學-薪資`,`研究所及以上-薪資`)
D$year<-103
rebind1<-rbind(A,B,C,D)
knitr::kable(rebind1)
```

| 大職業別              | 大學-薪資 | 研究所及以上-薪資 |  year|
|:----------------------|:----------|:------------------|-----:|
| 金融及保險業-專業人員 | 33646     | 38542             |   106|
| 金融及保險業-專業人員 | 33468     | 37895             |   105|
| 金融及保險業-專業人員 | 33706     | 38425             |   104|
| 金融及保險業-專業人員 | 33642     | 38123             |   103|

### 這些職業別研究所薪資與大學薪資差多少呢？

``` r
rebind2<-rbind(A,B,C,D)
rebind2$`大學-薪資`<-as.numeric(rebind2$`大學-薪資`)
rebind2$`研究所及以上-薪資`<-as.numeric(rebind2$`研究所及以上-薪資`)
rebind2$moremoney<-rebind2$`研究所及以上-薪資`-rebind2$`大學-薪資`
knitr::kable(rebind2)
```

| 大職業別              | 大學-薪資 | 研究所及以上-薪資 |  year|  moremoney|
|:----------------------|:---------:|:-----------------:|-----:|----------:|
| 金融及保險業-專業人員 |   33646   |       38542       |   106|       4896|
| 金融及保險業-專業人員 |   33468   |       37895       |   105|       4427|
| 金融及保險業-專業人員 |   33706   |       38425       |   104|       4719|
| 金融及保險業-專業人員 |   33642   |       38123       |   103|       4481|
